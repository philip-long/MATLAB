%% Define the parameters
Px = Td(1,4);
Py = Td(2,4);
Pz = Td(3,4);
sx = Td(1,1);
sy = Td(2,1);
sz = Td(3,1);
nx =Td(1,2);
ny = Td(2,2);
nz = Td(3,2);
ax = Td(1,3);
ay = Td(2,3);
az = Td(3,3);
R2 = r(2);
e = -1;



%% R3

c=-Px^2 - Py^2 - Pz^2 + R2^2;
R3 = (-c)^0.5*e

%% Theta 2

SQ = (e*(-Pz^2 + R3^2)^0.5)/R3;
CQ = Pz/R3;
t2 = atan2( SQ , CQ )


% Equation in t1

c=-(R3*sin(t2));
X=Px^2 + Py^2;
Y=-(c*Py) - Px*R2;
X1=-Px^2 - Py^2;
Y1=c*Px - Py*R2;
t1 = atan2(Y/X , Y1/X1 )